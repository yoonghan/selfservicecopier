/**
 * 
 * Tools to replace common modifiable texts. But this is a dangerous utility and have to be used with care. 
 * Such includes quotes " that will escape html quotes.
 * Scripts like <> that will write javascript that is never tested.
 * 
 * Usage
 * 		"<filename> + <path>" : { "<prefix>.<description>" : "<value>" }
 * 
 * Prefix of tt = tooltips.
 * Prefix of wr = warning messages in span tags.
 */

var txt_replacements =  {
	'selfservice/admin/view/eventsetup.html':{
		'tt.title'		: "Short description readable by public users.",
		'tt.desc' 		: "Describes what your event is for. I.e. \'Car Servicing and fixes. Call 123.\'",
		'tt.addInfo'	: "Request user to provide personal information before booking. Toggle request between MANDATORY or OPTIONAL value(s).",
		'tt.conf'		: "Double confirmation. Your confirmation is required before user can really reserve a place.",
		'tt.fullday'	: "Schedule your event as a full day( suggest in description) or break it into multiple slots. Define the maximum booking(s) per schedule.",
		'tt.occur'		: "Choose the dates your schedule occurs. Either per day or repeated based on days in a week.",
		'tt.blockDates' : "Useful to block dates for occured events. E.g. No events to occur on 2nd Dec 2015(Tuesday).",
		'tt.processForm': "Generate Reservations For Public View.",
		'tt.resetForm'	: "Clear All Inputted Data.",
		'tt.returnForm'	: "Cancel And Return To Calendar."
	},
	'selfservice/admin/view/eventsetup_submit.html':{
		'tt.collapseAll': "Collapse The Dates. Manually Opened Calendars Will Not Respond."
	},
	'selfservice/profile/view/reminder.html':{
		'wr.emailver': "Your email needs to be verified, please check your stated mailbox. The verification email may require up to 30 minutes to arrive at your mailbox.",
		'tt.reminder': "When the notification should occur to you before it's date.",
		'tt.notification': "How it should notify you, via email or sms.",
		'tt.allow': "Special request, which admin will notify if you're allowed to post."
	},
	'selfservice/admin/view/events.html':{
		'wr.reportgen' : "Go to <strong>Settings->Report</strong> to enable Report Generate activity and to learn more on report generation.",
		'wr.reportgenerated' : "Your report has been sent for generation. Please check your mailbox in 5 minutes.",
		'tt.reportgen' : "Go to Settings->Report to learn more on report generation.",
		'tt.viewUser' : "View Users"
	},
	'selfservice/admin/view/events_userlist.html':{
		'tt.actionwarning': "Your actions will affect your company image and reputation. Please consider before making one.",
		'tt.confUser' : "Confirm User",
		'tt.unsubUser' : "Unsubscribe User"
	}
}


/**
 * Introduce dynamic text replacer in server.
 * Cache have to be working for this, as regeneration of text replacement is painful.
 */
module.exports = function(path, buff){
		
	var keyReplacer = txt_replacements[path]
	
	if(keyReplacer != undefined){
		
		console.log("[NOTE] Scanned replacement for path:"+path);
		
		var buffToStr = buff.toString();
		
		for(var key in keyReplacer){
			buffToStr = buffToStr.replace("[["+key+"]]", keyReplacer[key]);
		}
		
		if(buffToStr.indexOf("[[") > -1){
			console.log("ERROR:- Some texts are not replaced for the path file:" + path);
		}
		
		buff = new Buffer(buffToStr);
	}
	
	return buff;
}
